---
title: 'Project 1: Exploratory Data Analysis'
author: "Melody Moreno mmm6969"
date: "9/16/2019"
output:
  html_document:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: yes
  pdf_document:
    toc: yes
---



<div id="eda-project" class="section level3">
<h3>EDA Project</h3>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>Both data sets were retrieved from github. The tv_ratings dataset includes a title ID, season number, title of the TV show, date the show was first aired, average rating, share, and genres. The movie_profit dataset includes the name of the movie, studio, the production budget, the domestic revenue (USA), worldwide revenue, distributor of the film, MPAA rating, and genre. I selected these because of my interest in TV and film.</p>
<pre class="r"><code>tv_ratings &lt;- readr::read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-08/IMDb_Economist_tv_ratings.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   titleId = col_character(),
##   seasonNumber = col_double(),
##   title = col_character(),
##   date = col_date(format = &quot;&quot;),
##   av_rating = col_double(),
##   share = col_double(),
##   genres = col_character()
## )</code></pre>
<pre class="r"><code>movie_profit &lt;- readr::read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2018/2018-10-23/movie_profit.csv&quot;)</code></pre>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   X1 = col_double(),
##   release_date = col_character(),
##   movie = col_character(),
##   production_budget = col_double(),
##   domestic_gross = col_double(),
##   worldwide_gross = col_double(),
##   distributor = col_character(),
##   mpaa_rating = col_character(),
##   genre = col_character()
## )</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## -- Attaching packages -------------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## &lt;U+2713&gt; ggplot2 3.2.1     &lt;U+2713&gt; purrr   0.3.3
## &lt;U+2713&gt; tibble  2.1.3     &lt;U+2713&gt; dplyr   0.8.3
## &lt;U+2713&gt; tidyr   1.0.0     &lt;U+2713&gt; stringr 1.4.0
## &lt;U+2713&gt; readr   1.3.1     &lt;U+2713&gt; forcats 0.4.0</code></pre>
<pre><code>## -- Conflicts ----------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(dplyr)</code></pre>
</div>
<div id="tidying" class="section level2">
<h2>Tidying</h2>
<p>na.omit was used to remove all NAs from the movie_profit and tv_ratings datasets, and then pivot wider was used to untidy the data and create a column for every genre. pivot_longer was used to tidy the data and combine all of the genre columns back into a single column, and then NAs were omitted.</p>
<pre class="r"><code>glimpse(movie_profit&lt;-movie_profit%&gt;%na.omit)</code></pre>
<pre><code>## Observations: 3,230
## Variables: 9
## $ X1                &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, …
## $ release_date      &lt;chr&gt; &quot;6/22/2007&quot;, &quot;7/28/1995&quot;, &quot;5/12/2017&quot;, &quot;12/25/2013&quot;…
## $ movie             &lt;chr&gt; &quot;Evan Almighty&quot;, &quot;Waterworld&quot;, &quot;King Arthur: Legend…
## $ production_budget &lt;dbl&gt; 1.75e+08, 1.75e+08, 1.75e+08, 1.75e+08, 1.70e+08, 1…
## $ domestic_gross    &lt;dbl&gt; 100289690, 88246220, 39175066, 38362475, 416769345,…
## $ worldwide_gross   &lt;dbl&gt; 174131329, 264246220, 139950708, 151716815, 1304866…
## $ distributor       &lt;chr&gt; &quot;Universal&quot;, &quot;Universal&quot;, &quot;Warner Bros.&quot;, &quot;Universa…
## $ mpaa_rating       &lt;chr&gt; &quot;PG&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, …
## $ genre             &lt;chr&gt; &quot;Comedy&quot;, &quot;Action&quot;, &quot;Adventure&quot;, &quot;Action&quot;, &quot;Action&quot;…</code></pre>
<pre class="r"><code>glimpse(movie_profit2&lt;-pivot_wider(movie_profit, names_from = genre,values_from = distributor))</code></pre>
<pre><code>## Observations: 3,230
## Variables: 12
## $ X1                &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, …
## $ release_date      &lt;chr&gt; &quot;6/22/2007&quot;, &quot;7/28/1995&quot;, &quot;5/12/2017&quot;, &quot;12/25/2013&quot;…
## $ movie             &lt;chr&gt; &quot;Evan Almighty&quot;, &quot;Waterworld&quot;, &quot;King Arthur: Legend…
## $ production_budget &lt;dbl&gt; 1.75e+08, 1.75e+08, 1.75e+08, 1.75e+08, 1.70e+08, 1…
## $ domestic_gross    &lt;dbl&gt; 100289690, 88246220, 39175066, 38362475, 416769345,…
## $ worldwide_gross   &lt;dbl&gt; 174131329, 264246220, 139950708, 151716815, 1304866…
## $ mpaa_rating       &lt;chr&gt; &quot;PG&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, …
## $ Comedy            &lt;chr&gt; &quot;Universal&quot;, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ Action            &lt;chr&gt; NA, &quot;Universal&quot;, NA, &quot;Universal&quot;, &quot;Universal&quot;, &quot;Wal…
## $ Adventure         &lt;chr&gt; NA, NA, &quot;Warner Bros.&quot;, NA, NA, NA, NA, NA, &quot;20th C…
## $ Drama             &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
## $ Horror            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…</code></pre>
<pre class="r"><code>glimpse(movie_profit2%&gt;%pivot_longer(8:12,names_to = &quot;genre&quot;, values_to = &quot;distributor&quot;)%&gt;%na.omit)</code></pre>
<pre><code>## Observations: 3,230
## Variables: 9
## $ X1                &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, …
## $ release_date      &lt;chr&gt; &quot;6/22/2007&quot;, &quot;7/28/1995&quot;, &quot;5/12/2017&quot;, &quot;12/25/2013&quot;…
## $ movie             &lt;chr&gt; &quot;Evan Almighty&quot;, &quot;Waterworld&quot;, &quot;King Arthur: Legend…
## $ production_budget &lt;dbl&gt; 1.75e+08, 1.75e+08, 1.75e+08, 1.75e+08, 1.70e+08, 1…
## $ domestic_gross    &lt;dbl&gt; 100289690, 88246220, 39175066, 38362475, 416769345,…
## $ worldwide_gross   &lt;dbl&gt; 174131329, 264246220, 139950708, 151716815, 1304866…
## $ mpaa_rating       &lt;chr&gt; &quot;PG&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, …
## $ genre             &lt;chr&gt; &quot;Comedy&quot;, &quot;Action&quot;, &quot;Adventure&quot;, &quot;Action&quot;, &quot;Action&quot;…
## $ distributor       &lt;chr&gt; &quot;Universal&quot;, &quot;Universal&quot;, &quot;Warner Bros.&quot;, &quot;Universa…</code></pre>
<pre class="r"><code>glimpse(tv_ratings&lt;-tv_ratings%&gt;%na.omit%&gt;%rename(tv_show=title))</code></pre>
<pre><code>## Observations: 2,266
## Variables: 7
## $ titleId      &lt;chr&gt; &quot;tt2879552&quot;, &quot;tt3148266&quot;, &quot;tt3148266&quot;, &quot;tt3148266&quot;, &quot;tt3…
## $ seasonNumber &lt;dbl&gt; 1, 1, 2, 3, 4, 1, 2, 1, 2, 3, 4, 5, 6, 7, 8, 1, 1, 1, 1,…
## $ tv_show      &lt;chr&gt; &quot;11.22.63&quot;, &quot;12 Monkeys&quot;, &quot;12 Monkeys&quot;, &quot;12 Monkeys&quot;, &quot;1…
## $ date         &lt;date&gt; 2016-03-10, 2015-02-27, 2016-05-30, 2017-05-19, 2018-06…
## $ av_rating    &lt;dbl&gt; 8.4890, 8.3407, 8.8196, 9.0369, 9.1363, 8.4370, 7.5089, …
## $ share        &lt;dbl&gt; 0.51, 0.46, 0.25, 0.19, 0.38, 2.38, 2.19, 6.67, 7.13, 5.…
## $ genres       &lt;chr&gt; &quot;Drama,Mystery,Sci-Fi&quot;, &quot;Adventure,Drama,Mystery&quot;, &quot;Adve…</code></pre>
<p>##Joining</p>
<p>Inner join was used to combine the two datasets by date into a single dataset (movie_tv). The formating of the dates in the tv_ratings dataset was changed to match the format in the movie_profit dataset. Inner_join was used because I wanted merge the release date and date columns on the two datasets and also drop all rows that contain NAs. 3110 cases were removed from the movie_profit dataset and 2140 cases were removed from the tv_ratings dataset. However, a potential problem with this is that it significantly decreased the total number of cases in the dataset and limits the amount of data that can be used for analyses.</p>
<pre class="r"><code>tv_ratings$date&lt;-format(tv_ratings$date, &quot;%m/%d/%Y&quot;)
movie_tv&lt;-movie_profit%&gt;%inner_join(tv_ratings, by=c(&quot;release_date&quot;=&quot;date&quot;))</code></pre>
</div>
<div id="dplyr-functions-and-summary-statistics" class="section level2">
<h2>dplyr functions and summary statistics</h2>
<pre class="r"><code># Filter
glimpse(movie_tv%&gt;%filter(mpaa_rating==&quot;R&quot;))</code></pre>
<pre><code>## Observations: 59
## Variables: 15
## $ X1                &lt;dbl&gt; 35, 195, 539, 830, 871, 956, 1045, 1131, 1254, 1293…
## $ release_date      &lt;chr&gt; &quot;11/24/2004&quot;, &quot;10/26/2012&quot;, &quot;12/25/2016&quot;, &quot;12/23/20…
## $ movie             &lt;chr&gt; &quot;Alexander&quot;, &quot;Cloud Atlas&quot;, &quot;Live by Night&quot;, &quot;Silen…
## $ production_budget &lt;dbl&gt; 1.55e+08, 1.02e+08, 6.50e+07, 4.65e+07, 4.50e+07, 4…
## $ domestic_gross    &lt;dbl&gt; 34297191, 27108272, 10378555, 7100177, 22951340, 54…
## $ worldwide_gross   &lt;dbl&gt; 167297191, 130673154, 21778555, 23727516, 79604820,…
## $ distributor       &lt;chr&gt; &quot;Warner Bros.&quot;, &quot;Warner Bros.&quot;, &quot;Warner Bros.&quot;, &quot;Pa…
## $ mpaa_rating       &lt;chr&gt; &quot;R&quot;, &quot;R&quot;, &quot;R&quot;, &quot;R&quot;, &quot;R&quot;, &quot;R&quot;, &quot;R&quot;, &quot;R&quot;, &quot;R&quot;, &quot;R&quot;, &quot;…
## $ genre             &lt;chr&gt; &quot;Action&quot;, &quot;Drama&quot;, &quot;Drama&quot;, &quot;Drama&quot;, &quot;Drama&quot;, &quot;Come…
## $ titleId           &lt;chr&gt; &quot;tt0417349&quot;, &quot;tt1279972&quot;, &quot;tt2699110&quot;, &quot;tt1578873&quot;,…
## $ seasonNumber      &lt;dbl&gt; 1, 3, 3, 7, 2, 3, 7, 1, 1, 1, 3, 5, 2, 3, 1, 9, 1, …
## $ tv_show           &lt;chr&gt; &quot;North &amp; South&quot;, &quot;Treme&quot;, &quot;The Affair&quot;, &quot;Pretty Lit…
## $ av_rating         &lt;dbl&gt; 7.7259, 8.1682, 7.5078, 7.5756, 8.6548, 9.0598, 7.5…
## $ share             &lt;dbl&gt; 0.32, 0.09, 0.13, 0.30, 0.67, 0.30, 0.30, 1.10, 0.1…
## $ genres            &lt;chr&gt; &quot;Drama,Romance&quot;, &quot;Drama,Music&quot;, &quot;Drama&quot;, &quot;Drama,Mys…</code></pre>
<pre class="r"><code># Select
glimpse(movie_tv%&gt;%select(release_date,movie,tv_show))</code></pre>
<pre><code>## Observations: 120
## Variables: 3
## $ release_date &lt;chr&gt; &quot;11/24/2004&quot;, &quot;12/14/2007&quot;, &quot;12/12/2014&quot;, &quot;11/18/2011&quot;, …
## $ movie        &lt;chr&gt; &quot;Alexander&quot;, &quot;I am Legend&quot;, &quot;Exodus: Gods and Kings&quot;, &quot;H…
## $ tv_show      &lt;chr&gt; &quot;North &amp; South&quot;, &quot;Lost: Missing Pieces&quot;, &quot;Marco Polo&quot;, &quot;…</code></pre>
<pre class="r"><code># Arrange
glimpse(movie_tv%&gt;%arrange(release_date))</code></pre>
<pre><code>## Observations: 120
## Variables: 15
## $ X1                &lt;dbl&gt; 1131, 2290, 2818, 3122, 3122, 3030, 224, 224, 1053,…
## $ release_date      &lt;chr&gt; &quot;10/13/2017&quot;, &quot;10/13/2017&quot;, &quot;10/13/2017&quot;, &quot;10/16/20…
## $ movie             &lt;chr&gt; &quot;The Foreigner&quot;, &quot;Marshall&quot;, &quot;Happy Death Day&quot;, &quot;Mi…
## $ production_budget &lt;dbl&gt; 3.5e+07, 1.2e+07, 5.0e+06, 2.1e+06, 2.1e+06, 3.0e+0…
## $ domestic_gross    &lt;dbl&gt; 34393507, 10051659, 55683845, 3330, 3330, 84752907,…
## $ worldwide_gross   &lt;dbl&gt; 140783646, 10116816, 125013000, 3330, 3330, 1775120…
## $ distributor       &lt;chr&gt; &quot;STX Entertainment&quot;, &quot;Open Road&quot;, &quot;Universal&quot;, &quot;Ind…
## $ mpaa_rating       &lt;chr&gt; &quot;R&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, &quot;R&quot;, &quot;R&quot;, &quot;R&quot;, &quot;PG-13&quot;, &quot;PG-…
## $ genre             &lt;chr&gt; &quot;Action&quot;, &quot;Drama&quot;, &quot;Horror&quot;, &quot;Drama&quot;, &quot;Drama&quot;, &quot;Hor…
## $ titleId           &lt;chr&gt; &quot;tt5290382&quot;, &quot;tt5290382&quot;, &quot;tt5290382&quot;, &quot;tt5519574&quot;,…
## $ seasonNumber      &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 4, 4, 4, 4, 4, 3, 3, …
## $ tv_show           &lt;chr&gt; &quot;Mindhunter&quot;, &quot;Mindhunter&quot;, &quot;Mindhunter&quot;, &quot;Notoriou…
## $ av_rating         &lt;dbl&gt; 8.4384, 8.4384, 8.4384, 7.1446, 7.4228, 7.8315, 8.0…
## $ share             &lt;dbl&gt; 1.10, 1.10, 1.10, 0.03, 0.04, 0.14, 0.04, 0.97, 0.0…
## $ genres            &lt;chr&gt; &quot;Crime,Drama,Thriller&quot;, &quot;Crime,Drama,Thriller&quot;, &quot;Cr…</code></pre>
<pre class="r"><code># Group by
glimpse(movie_tv%&gt;%group_by(genre)%&gt;%summarize(mean_production_budget=mean(production_budget)))</code></pre>
<pre><code>## Observations: 5
## Variables: 2
## $ genre                  &lt;chr&gt; &quot;Action&quot;, &quot;Adventure&quot;, &quot;Comedy&quot;, &quot;Drama&quot;, &quot;Hor…
## $ mean_production_budget &lt;dbl&gt; 66100000, 63800000, 32461538, 20017568, 213076…</code></pre>
<pre class="r"><code># Mutate 
glimpse(movie_tv%&gt;%mutate(domestic_gross_rank=percent_rank(domestic_gross)))</code></pre>
<pre><code>## Observations: 120
## Variables: 16
## $ X1                  &lt;dbl&gt; 35, 43, 87, 101, 104, 195, 224, 224, 372, 416, 42…
## $ release_date        &lt;chr&gt; &quot;11/24/2004&quot;, &quot;12/14/2007&quot;, &quot;12/12/2014&quot;, &quot;11/18/…
## $ movie               &lt;chr&gt; &quot;Alexander&quot;, &quot;I am Legend&quot;, &quot;Exodus: Gods and Kin…
## $ production_budget   &lt;dbl&gt; 1.55e+08, 1.50e+08, 1.40e+08, 1.35e+08, 1.32e+08,…
## $ domestic_gross      &lt;dbl&gt; 34297191, 256393010, 65014513, 64006466, 83350911…
## $ worldwide_gross     &lt;dbl&gt; 167297191, 585532684, 268314513, 157956466, 36765…
## $ distributor         &lt;chr&gt; &quot;Warner Bros.&quot;, &quot;Warner Bros.&quot;, &quot;20th Century Fox…
## $ mpaa_rating         &lt;chr&gt; &quot;R&quot;, &quot;PG-13&quot;, &quot;PG-13&quot;, &quot;PG&quot;, &quot;PG&quot;, &quot;R&quot;, &quot;PG-13&quot;, …
## $ genre               &lt;chr&gt; &quot;Action&quot;, &quot;Horror&quot;, &quot;Drama&quot;, &quot;Adventure&quot;, &quot;Advent…
## $ titleId             &lt;chr&gt; &quot;tt0417349&quot;, &quot;tt1150692&quot;, &quot;tt2189461&quot;, &quot;tt1888075…
## $ seasonNumber        &lt;dbl&gt; 1, 1, 1, 1, 3, 3, 1, 1, 9, 1, 1, 5, 9, 3, 3, 3, 1…
## $ tv_show             &lt;chr&gt; &quot;North &amp; South&quot;, &quot;Lost: Missing Pieces&quot;, &quot;Marco P…
## $ av_rating           &lt;dbl&gt; 7.7259, 7.4951, 8.1780, 7.7066, 9.0598, 8.1682, 8…
## $ share               &lt;dbl&gt; 0.32, 0.19, 0.38, 0.17, 0.30, 0.09, 0.04, 0.97, 0…
## $ genres              &lt;chr&gt; &quot;Drama,Romance&quot;, &quot;Drama,Fantasy,Sci-Fi&quot;, &quot;Adventu…
## $ domestic_gross_rank &lt;dbl&gt; 0.6302521, 1.0000000, 0.8571429, 0.8487395, 0.899…</code></pre>
<p>Summarise was used to generate the mean, standard deviation, variance, IQR, minimum, maximum, median, number of distinct cases, first value, and last values of the production_budget, domestic_gross, worldwide_gross, av_rating, and share variables. Then these summary statistics were generated for worldwide_gross when grouped by genre. Summary statistics were also calculated for production_budget when grouped by mpaa rating.</p>
<pre class="r"><code># Production Budget 
movie_tv%&gt;%summarise(mean_pb=mean(production_budget),sd_pb=sd(production_budget),var_pb=var(production_budget),IQR_pb=IQR(production_budget),min_pb=min(production_budget),med_bp=median(production_budget),max_pb=max(production_budget),ndist_pb=n_distinct(production_budget),first_pb=first(production_budget), last_pb=last(production_budget))</code></pre>
<pre><code>## # A tibble: 1 x 10
##    mean_pb   sd_pb  var_pb IQR_pb min_pb med_bp max_pb ndist_pb first_pb last_pb
##      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   2.90e7  3.20e7 1.03e15 2.62e7 500000 2.00e7 1.55e8       58   1.55e8  500000</code></pre>
<pre class="r"><code># Domestic Gross
movie_tv%&gt;%summarise(mean_dg=mean(domestic_gross),sd_dg=sd(domestic_gross),var_dg=var(domestic_gross),IQR_dg=IQR(domestic_gross),min_dg=min(domestic_gross),med_dg=median(domestic_gross),max_dg=max(domestic_gross),ndist_dg=n_distinct(domestic_gross),first_dg=first(domestic_gross),last_dg=last(domestic_gross))</code></pre>
<pre><code>## # A tibble: 1 x 10
##    mean_dg   sd_dg  var_dg IQR_dg min_dg med_dg max_dg ndist_dg first_dg last_dg
##      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   3.45e7  4.31e7 1.86e15 4.64e7      0 1.83e7 2.56e8      101 34297191  237301</code></pre>
<pre class="r"><code># Worldwide Gross
movie_tv%&gt;%summarise(mean_wg=mean(worldwide_gross),sd_wg=sd(worldwide_gross),var_wg=var(worldwide_gross),IQR_wg=IQR(worldwide_gross),min_wg=min(worldwide_gross),med_wg=median(worldwide_gross),max_wg=max(worldwide_gross),ndist_wg=n_distinct(worldwide_gross),first_wg=first(worldwide_gross),last_wg=last(worldwide_gross))</code></pre>
<pre><code>## # A tibble: 1 x 10
##    mean_wg   sd_wg  var_wg IQR_wg min_wg med_wg max_wg ndist_wg first_wg last_wg
##      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   8.05e7  9.63e7 9.27e15 1.11e8      0 5.11e7 5.86e8      102   1.67e8 5639730</code></pre>
<pre class="r"><code># Average Rating
movie_tv%&gt;%summarise(mean_rating=mean(av_rating),sd_rating=sd(av_rating),var_rating=var(av_rating),IQR_rating=IQR(av_rating),min_rating=min(av_rating),med_rating=median(av_rating),max_rating=max(av_rating),ndist_rating=n_distinct(av_rating),first_rating=first(av_rating),last_rating=last(av_rating))</code></pre>
<pre><code>## # A tibble: 1 x 10
##   mean_rating sd_rating var_rating IQR_rating min_rating med_rating max_rating
##         &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1        8.18     0.431      0.186      0.540       7.14       8.18       9.31
## # … with 3 more variables: ndist_rating &lt;int&gt;, first_rating &lt;dbl&gt;,
## #   last_rating &lt;dbl&gt;</code></pre>
<pre class="r"><code># Share
movie_tv%&gt;%summarise(mean_share=mean(share),sd_share=sd(share),var_share=var(share),IQR_share=IQR(share),min_share=min(share),med_share=median(share),max_share=max(share),ndist_share=n_distinct(share),first_share=first(share),last_share=last(share))</code></pre>
<pre><code>## # A tibble: 1 x 10
##   mean_share sd_share var_share IQR_share min_share med_share max_share
##        &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1      0.976     2.03      4.13      1.01      0.02      0.32      19.4
## # … with 3 more variables: ndist_share &lt;int&gt;, first_share &lt;dbl&gt;,
## #   last_share &lt;dbl&gt;</code></pre>
<pre class="r"><code># Worldwide Gross grouped be Genre
movie_tv%&gt;%group_by(genre)%&gt;%summarise(mean_wg=mean(worldwide_gross),sd_wg=sd(worldwide_gross),var_wg=var(worldwide_gross),IQR_wg=IQR(worldwide_gross),min_wg=min(worldwide_gross),med_wg=median(worldwide_gross),max_wg=max(worldwide_gross),ndist_wg=n_distinct(worldwide_gross),first_wg=first(worldwide_gross),last_wg=last(worldwide_gross))</code></pre>
<pre><code>## # A tibble: 5 x 11
##   genre mean_wg  sd_wg  var_wg IQR_wg min_wg med_wg max_wg ndist_wg first_wg
##   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;int&gt;    &lt;dbl&gt;
## 1 Acti…  1.26e8 6.79e7 4.61e15 1.03e8 3.83e7 1.36e8 2.21e8        9   1.67e8
## 2 Adve…  1.60e8 1.32e8 1.73e16 1.79e8 5.54e6 1.39e8 3.68e8       10   1.58e8
## 3 Come…  7.52e7 5.44e7 2.96e15 6.92e7 5.31e6 5.43e7 1.72e8       12   5.43e7
## 4 Drama  5.22e7 7.64e7 5.84e15 6.61e7 0.     1.96e7 3.85e8       59   2.68e8
## 5 Horr…  1.51e8 1.40e8 1.97e16 9.57e7 2.47e7 1.03e8 5.86e8       12   5.86e8
## # … with 1 more variable: last_wg &lt;dbl&gt;</code></pre>
<pre class="r"><code># Production Budget grouped by MPAA Rating
movie_tv%&gt;%group_by(mpaa_rating)%&gt;%summarise(mean_pb=mean(production_budget),sd_pb=sd(production_budget),var_pb=var(production_budget),IQR_pb=IQR(production_budget),min_pb=min(production_budget),med_bp=median(production_budget),max_pb=max(production_budget),ndist_pb=n_distinct(production_budget),first_pb=first(production_budget),last_pb=last(production_budget))</code></pre>
<pre><code>## # A tibble: 4 x 11
##   mpaa_rating mean_pb    sd_pb   var_pb IQR_pb min_pb med_bp max_pb ndist_pb
##   &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;int&gt;
## 1 G            7.00e6 NaN      NA       0.     7.00e6 7.00e6 7.00e6        1
## 2 PG           4.87e7   3.86e7  1.49e15 3.75e7 7.50e6 3.80e7 1.35e8       11
## 3 PG-13        3.39e7   3.52e7  1.24e15 2.80e7 8.00e5 2.40e7 1.50e8       30
## 4 R            2.06e7   2.46e7  6.06e14 1.52e7 5.00e5 1.60e7 1.55e8       38
## # … with 2 more variables: first_pb &lt;dbl&gt;, last_pb &lt;dbl&gt;</code></pre>
</div>
<div id="visualizations" class="section level2">
<h2>Visualizations</h2>
<p>A scatterplot was generated with production budget as the x value and worldwide gross as the y value, and then faceted by mpaa rating. The plots generally show that as production budget increases, worldwide gross increases for PG, PG-13, and R rated movies. Only one case had an mpaa rating of G and therefore there was not enough data to determine any trends.</p>
<pre class="r"><code>library(ggplot2)
ggplot(movie_tv, aes(movie_tv$production_budget,movie_tv$worldwide_gross, color=movie_tv$mpaa_rating))+geom_point(stat=&quot;summary&quot;, fun.y=&quot;mean&quot;)+xlab(&quot;Production Budget&quot;)+ylab(&quot;Average Worldwide Gross&quot;)+ggtitle(&quot;Average Worldwide Gross by Production Budget and MPAA Rating&quot;)+facet_wrap(~movie_tv$mpaa_rating)+theme_dark()+theme(legend.position=&quot;none&quot;)</code></pre>
<p><img src="/Project1_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>A scatterplot was created using season number as the x value and average rating as the y value, and the points were colored by genres. The plot shows that av_rating increases as season number increases until around the 5th season, then the plot shows a decrease in av_rating. There appears to be no significant relationship between ratings and genres</p>
<pre class="r"><code>ggplot(movie_tv, aes(x = movie_tv$seasonNumber, y=movie_tv$av_rating, color=movie_tv$genres))+geom_point()+theme(legend.position=&quot;none&quot;)+xlab(&quot;Season Number&quot;)+ylab(&quot;Rating&quot;)+ggtitle(&quot;Ratings by Season Number&quot;)+scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10))</code></pre>
<p><img src="/Project1_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="clustering" class="section level2">
<h2>Clustering</h2>
<p>The data shows mean domestic gross by production budget clustered by mpaa rating (4 clusters, 1 per rating). The means show an increase from G rating, to R, to PG-13, and then to PG.</p>
<pre class="r"><code># selecting variables for clustering
clust_data&lt;-movie_tv%&gt;%dplyr::select(production_budget,domestic_gross,mpaa_rating)

#assigning values to cluster and calculating means 
cent&lt;-movie_tv%&gt;%mutate(cluster=sample(c(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;),120,replace=T))%&gt;%
  group_by(as.factor(mpaa_rating))%&gt;%summarize(production_budget=mean(production_budget),domestic_gross=mean(domestic_gross))

mov&lt;-movie_tv%&gt;%mutate(dist1=sqrt((production_budget-cent$production_budget[1])^2+(domestic_gross-cent$domestic_gross[1])^2),dist2=sqrt((production_budget-cent$production_budget[2])^2+(domestic_gross-cent$domestic_gross[2])^2),dist3=sqrt((production_budget-cent$production_budget[3])^2+(domestic_gross-cent$domestic_gross[3])^2), dist4=sqrt((production_budget-cent$production_budget[4]^2+domestic_gross-cent$domestic_gross[4]^2)))%&gt;%rowwise()%&gt;%mutate(cluster=as.factor(which.min(c(dist1,dist2,dist3,dist4))))</code></pre>
<pre><code>## Warning in sqrt((production_budget - cent$production_budget[4]^2 +
## domestic_gross - : NaNs produced</code></pre>
<pre><code>## Warning in mutate_impl(.data, dots, caller_env()): Unequal factor levels:
## coercing to character</code></pre>
<pre><code>## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector

## Warning in mutate_impl(.data, dots, caller_env()): binding character and factor
## vector, coercing into character vector</code></pre>
<pre class="r"><code># generating plot 
ggplot(mov)+geom_point(aes(production_budget, domestic_gross,color=as.factor(mpaa_rating)))+
  geom_point(data=cent,aes(production_budget,domestic_gross),size=5)+ggtitle(&quot;Domestic Gross by Production Budget&quot;)+xlab(&quot;Production Budget&quot;)+ylab(&quot;Domestic Gross&quot;)</code></pre>
<p><img src="/Project1_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
